<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>后台管理系统</title>
<meta charset="UTF-8"/>
<link rel="stylesheet" href="../css/font.css">
<link rel="stylesheet" href="../css/xadmin.css">
<script type="text/javascript" src="../layui/layui.js"></script>
<script type="text/javascript" src="../libs/jquery-3.1.1.min.js"></script>
<script type="text/javascript" src="../libs/xadmin.js"></script>
</head>
<body class="login-bg">
	<div class="login">
		<div class="message">后台管理系统</div>
		<div id="darkbannerwrap"></div>
		<form class="layui-form" id="login_form">
			<input id="login" name="login" placeholder="用户名" type="text"
				lay-verify="required" class="layui-input">
			<hr class="hr15">
			<input id="password" name="password" lay-verify="required"
				placeholder="密码" type="password" class="layui-input">
			<hr class="hr15">
			<hr class="hr20">
		</form>
			<input value="登录" lay-submit lay-filter="login" style="width: 100%;"
				type="submit" id="login_button" key>
	</div>
	<script>
		$(function() {
		    $.ajax({
                url: "../check_login",
                type: "post",
                success: function (data) {
                    if(data.code == 200){
                        $(location).prop('href', 'index.html');
                    }
                }
            });
			$("#login_button").click(function() {
                login();
			});
		});
        $(document).keypress(function(e) {
            var eCode = e.keyCode ? e.keyCode : e.which ? e.which : e.charCode;
            if (eCode == 13){
                login();
            }
        });
        function login() {
            var i = 0;
            var msg = "";
            var login = $("#login").val();
            var password = $("#password").val();
            if (login == "") {
                i++;
                msg +="登录名不能为空;";
            }
            if (password == "") {
                i++;
                msg +="密码不能为空;";
            }
            if (i == 0) {
                $.ajax({
                    url : "../login",
                    data : $("#login_form").serialize(),
                    type : "post",
                    success : function(msg) {
                        //登录成功
                        if (msg.code == 200) {
                            layer.msg("登录成功", {
                                icon : 1,
                                time : 1000
                            });
                            $(location).prop('href', 'index.html');
                        }//登录失败
                        else {
                            layer.msg("用户名或密码错误", {
                                icon : 2,
                                time : 1000
                            });
                        }
                    },
                    error : function() {
                        layer.msg("登录失败!!", {
                            icon : 2,
                            time : 1000
                        });
                    }
                });
            }else{
                layer.msg(msg, {
                    icon : 2,
                    time : 2000
                });
            }
        }
	</script>

</body>
</html>